# 실시간 여행 상품 유저 여정 데이터 파이프라인

실제 여행 이커머스 환경을 가정하여  
**대규모 사용자 행동 데이터를 실시간으로 수집·처리·분석하고,  
비즈니스 의사결정을 지원하는 스트리밍 데이터 파이프라인**을 구축한 프로젝트입니다.

Go–Kafka–Flink–ClickHouse–Grafana로 이어지는  
**End-to-End 실시간 데이터 흐름을 직접 설계·구현**했습니다.

---

## 프로젝트 목적

- 여행 이커머스의 **복잡한 유저 여정(검색 → 클릭 → 구매)**을  
  단순 로그가 아닌 세션 기반의 **State / Event 기반 실시간 스트림 데이터**로 추적
- 대규모 트래픽 상황에서도 **정합성과 지연 없는 분석 환경** 구축
- 기획·마케팅·운영 관점에서 활용 가능한 **실시간 BI 대시보드 제공**

---

## 핵심 구현 내용

### 1. 고성능 이벤트 생성 (Go)

- FSM(Finite State Machine) 기반 유저 행동 시뮬레이션
- 실제 커머스 흐름을 반영한 상태 전이 모델
- 초당 **20,000 (TPS)** 이벤트 안정적 생성
- UserID 기반 Kafka Key 파티셔닝으로 이벤트 순서 보장

### 2. 실시간 스트림 처리 (Kafka + Flink)

- Kafka → Flink → ClickHouse 실시간 파이프라인 구축
- Exactly-Once 처리 보장 (Checkpoint 기반 장애 복구)
- Kafka 파티션 수와 Flink 병렬도 1:1 매핑으로 처리 효율 극대화

### 3. 실시간 분석 및 시각화 (ClickHouse + Grafana)

- JSON 로그를 ClickHouse에서 실시간 파싱하여 OLAP 분석
- 유저 퍼널 전환율, 국가/카테고리/결제수단별 지표 시각화

---

## 핵심 구현 내용

### 성능 테스트 및 트러블 슈팅

- 성능 테스트 결과

| 설정 (P-P-W) | 배치 사이즈 | 평균 Lag | 상태 | 비고 |
|-------------|------------|----------|------|------|
| 4 - 4 - 4 | 15,000 | 90,000 | 정체 | Sink 병목 확인 |
| 4 - 4 - 4 | 25,000 | 75,000 | 정체 감소 | Sink 성능 개선, 처리량 부족 |
| 8 - 8 - 8 | 25,000 | 18,000 | 정체 대폭 감소 | 개선 여지 있음 |
| 16 - 16 - 16 | 25,000 | 40,000 | 정체 오히려 증가 | 성능 이슈로 자원 배분이 원활하지 않은 것으로 보임 |
| 12 - 12 - 12 | 25,000 (인터벌 1초) | 5,500 | 최적화 | Sweet Spot |
| 12 - 12 - 12 | 50,000 (인터벌 2.5초) | 6,700 | 정체 소폭 증대 | 인터벌 증가로 인한 차이(성능-비용 트레이드 오프) |

- 트러블 슈팅
  : 하단의 노션 링크 접속 후 목차 6에서 확인

---

## 아키텍처 및 대시보드 이미지 

(1) 아키텍처

![Architecture](images/architecture.png)

(2) Grafana 대시보드

![Architecture](images/grafana_dashboard.png)


---

## 기술 스택

- **Language**: Go, Java
- **Streaming**: Kafka (KRaft), Apache Flink
- **Storage**: ClickHouse (OLAP)
- **Visualization**: Grafana
- **Infra**: Docker Compose

---

## 성과

- 초당 **20,000 (TPS)** 실시간 이벤트 처리 성능 검증
- Exactly-Once 기반 데이터 정합성 확보
- 단순 로그가 아닌 **유저 여정 중심 분석 구조 구현**
- 여행 이커머스 도메인을 반영한 실무 지향 파이프라인 설계 경험

---

## 참고 사항
- 노션(Notion) 링크 : https://www.notion.so/2e3ad6468ffc80478af0d9785d8a50bc?source=copy_link
